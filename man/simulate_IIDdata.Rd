% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_IIDdata.r
\name{simulate_IIDdata}
\alias{simulate_IIDdata}
\title{Simulate IID Data from a Wide Range of Distributions}
\usage{
simulate_IIDdata(
  n,
  distr_name,
  distr_params = distr_spec(),
  generator = NULL,
  seed = NULL
)
}
\arguments{
\item{n}{Integer (>0). Number of IID observations to simulate.
Fractional values are rounded down to the nearest integer.}

\item{distr_name}{Character string specifying the target distribution.
See \link[=simulate_IIDdata]{Details} for full information on aliases,
parameter handling, and examples.  Supported options (case-insensitive) include:
\itemize{
\item \strong{Base R distributions:} \code{"normal"}, \code{"gaussian"}, \code{"binomial"}, \code{"poisson"},
\code{"uniform"}, \code{"gamma"}, \code{"beta"}, \code{"chisq"}, etc.
See the full list of base R distributions at:
\url{https://stat.ethz.ch/R-manual/R-devel/library/stats/html/Distributions.html}
\item \strong{Multivariate distributions:} \code{"mvnorm"}, \code{"mvt"}, \code{"mvst"}, \code{"mvsnorm"}.
\item \strong{Copula-based generation:} \code{"copula"} → see @details for usage.
\item \strong{Custom generator:}  \code{"custom"} → requires providing \code{generator}.
\item \strong{Explicit package-qualified functions:}  any \code{"pkg::fun"} form
(e.g., \code{"MASS::mvrnorm"})
\item \strong{External functions without package prefix:}
the simulator attempts to locate a matching function across
all installed packages via \code{\link{match.fun.allR}}.
}}

\item{distr_params}{Named list of distribution parameters,
usually created with \code{\link[=distr_spec]{distr_spec()}}.
Can include an optional argument \code{dim} representing the dimension of the random variables.
For multivariate distributions, \code{dim} must either be supplied explicitly
or be inferable from the user-supplied location, scale, or shape parameters
(or from the 'copula' object if \code{distr_name = "copula"}).
If \code{distr_params} is not a list, it is interpreted as:
\itemize{
\item The \strong{copula object} if \code{distr_name = "copula"}.
\item The \strong{dimension} (\code{dim}) if \code{distr_name} is neither "copula" nor "custom".
}}

\item{generator}{A user-defined random generator function, used only when
\code{distr_name = "custom"}. Must accept at least the
argument \code{n}, and return either a vector of length \code{n}
or a matrix of dimension \code{n × dim}).}

\item{seed}{Optional integer. If provided, the RNG state is temporarily
replaced with this seed, and restored upon exit.}
}
\value{
A numeric matrix (with class \code{"IIDdata"}) with \code{n} rows and \code{dim} columns.
Each row is an IID observation of dimension \code{dim}.
}
\description{
Generates independent and identically distributed (IID) random samples
with flexibility and ease of control.

The function supports standard R random generators (e.g., \code{rnorm}, \code{rpois}),
external generator functions from \emph{all installed R packages}
(e.g., \verb{\pkg{sn}}, \verb{\pkg{mvtnorm}}, \verb{\pkg{VGAM}},\verb{\pkg{extraDistr}}, \verb{\pkg{gamlss.dist}}, \verb{\pkg{gamlss.dist}}),
copula-based multivariate distributions (via \verb{\pkg{copula}})
as well as user-defined custom generators (supplied via the \code{generator} argument).
User-supplied parameters override defaults produced by \code{\link[=distr_spec]{distr_spec()}}.
}
\details{
\itemize{
\item \strong{Copula-based simulations:} \code{distr_params} must contain a \code{copula} object (from \pkg{copula})
and an optional list \code{margins} of length \code{dim} (>1).
Each element of \code{margins}, if provided, must be a list containing
- \code{dist}: univariate distribution name (e.g. \code{"norm"}),
- \code{params}: named list of distribution parameters.
The simulator first draws \eqn{U}  from the specified copula \eqn{C}
and applies the appropriate quantile functions to obtain the final multivariate sample.
\emph{Defaults:} If \code{dim} is missing, it is inferred from the copula object;
if \code{margins} is missing, all margins are taken to be standard normal.

\if{html}{\out{<div class="sourceCode">}}\preformatted{    An informative error is raised if there is a dimension mismatch between the copula
    and the user-supplied arguments.
}\if{html}{\out{</div>}}

\item \strong{Custom generators:} Only arguments matching \code{generator}'s formal arguments are passed.
Sample size is forwarded as \code{n}.

\item \strong{External generators with specified r package:}
If \code{distr_name} is provided in the form \code{"pkg::function"},
the simulator dynamically loads the specified function from the indicated package.
An error is raised if the package is not installed.

\item \strong{External generators without package prefix:}
If \code{distr_name} is \strong{not} of the form \code{"pkg::function"},
the function first looks for a base R random generator (e.g., \code{rnorm}, \code{rpois}).
If none is found, it searches all installed packages for a matching exported function,
prepending \code{r} if needed (e.g., \code{norm} → \code{rnorm}).
An informative error is raised if no suitable function is found.
\strong{Warning:} naming conflicts across packages may lead to unexpected behavior.

\item \strong{Sample-size detection:}
The function automatically detects \code{n} or \code{nn} within formal arguments.
If neither exists, \code{n} is passed as the first positional argument
(specifying the sample size).
}

\strong{Distribution name aliases:}
The argument \code{distr_name} supports the following (case-insensitive) aliases for common distributions.
\tabular{llll}{
\emph{Distribution}             \tab Aliases                    → Internal function         \tab \code{distr_params} (with defaults)\cr
Binomial                   \tab binomial, binom            → \link{rbinom}             \tab size = 1, prob = 0.5\cr
Poisson                    \tab poisson, pois              → \link{rpois}              \tab lambda = 1\cr
Normal                     \tab normal, gaussian, norm     → \link{rnorm}              \tab mean = 0, sd = 1\cr
Multivariate Normal        \tab mvnorm, mvn                → \link[mvtnorm:Mvnorm]{mvtnorm::rmvnorm}   \tab mean = rep(0, dim), sigma = diag(dim)\cr
Multivariate Normal (Singular)   \tab smvnorm, smvn        → \link[mgcv:rmvn]{mgcv::rmvn}         \tab mu = rep(0, dim), V = diag(dim)\cr
Multivariate t             \tab mvt                        → \link[mvtnorm:Mvt]{mvtnorm::rmvt}      \tab sigma = diag(dim), df = 5, delta = rep(0, dim)\cr
Multivariate t (Singular)  \tab smvt                       → \link[mgcv:rmvn]{mgcv::r.mvt}       \tab mu = rep(0, dim), V = diag(dim), df = 5\cr
Skew-normal (univariate)   \tab skewnorm, sn               → \link[sn:dsn]{sn::rsn}            \tab xi = 0, omega = 1, alpha = 0, tau = 0\cr
Skew-normal (multivariate) \tab mvsnorm, mvsn              → \link[sn:dmsn]{sn::rmsn}           \tab xi = alpha = rep(0, dim), Omega = diag(dim), tau = 0 \cr
Skew-t (univariate)        \tab skewt, st                  → \link[sn:dst]{sn::rst}            \tab xi = 0, omega = 1, alpha = 0, nu = 5\cr
Skew-t (multivariate)      \tab mvskewt, mvst              → \link[sn:dmst]{sn::rmst}           \tab xi = alpha = rep(0, dim), Omega = diag(dim), nu = 5\cr
Pareto (type I)            \tab pareto, pareto_I           → \link[VGAM:ParetoUC]{VGAM::rpareto}      \tab scale = 1, shape = 1 (k parameter)  \cr
Laplace                    \tab laplace, double_exp        → \link[VGAM:laplaceUC]{VGAM::rlaplace}     \tab location = 0, scale = 1  \cr
}
Functions from external packages (e.g., \code{sn::rmsn}) may also be specified
without the package prefix  if no naming conflict exists,
though this can lead to ambiguity or unexpected behavior.
Omitting the leading \code{r} is allowed for internal R function names
when the package name is not explicitly specified using \code{::}.

See the \href{https://CRAN.R-project.org/view=Distributions}{CRAN Task View on Distributions}
for a comprehensive list of R packages providing additional distributions,
all of which can be used within this simulator with suitable \code{distr_name} and \code{distr_params}.
}
\section{Dependencies}{

Depending on the distribution specified in \code{distr_name},
one or more of the following packages may be optionally required
(depending on the case):
\itemize{
\item \pkg{copula} – For copula-based generation (\code{distr_name = "copula"}).
CRAN: \url{https://CRAN.R-project.org/package=copula}
\item \pkg{mvtnorm} – For multivariate normal (\code{"mvnorm", "mvt"}) and t distributions.
CRAN: \url{https://CRAN.R-project.org/package=mvtnorm}
\item \pkg{sn} – For skew-normal and skew-t distributions (both univariate and multivariate:
\code{"skewnorm", "skewt", "mvsnorm", "mvskewt"}).
CRAN: \url{https://CRAN.R-project.org/package=sn}
\item \pkg{VGAM} – For non-standard univariate distributions such as Pareto, Laplace, and others:
\code{"pareto", "laplace"}.
CRAN: \url{https://CRAN.R-project.org/package=VGAM}
\item \pkg{extraDistr} – Provides additional discrete and continuous distributions
(e.g., generalized beta, zero-inflated distributions).
CRAN: \url{https://CRAN.R-project.org/package=extraDistr}
\item \pkg{MASS} – For distributions like negative binomial (\code{"MASS::rnegbin"}).
CRAN: \url{https://CRAN.R-project.org/package=MASS}
\item Any other R package \code{"pkg"} that provides a function specified
via \code{"pkg::fun"} in \code{distr_name}.
The function will attempt to dynamically load the specified function from the package.
}
}

\examples{
# A Basic Example
set.seed(123)
x <- simulate_IIDdata(500, "laplace")
mean(x); var(x); hist(x)

# From a recommended package (MASS)
x <- simulate_IIDdata(5, "MASS::rnegbin", list(mu = 5, theta = 2))
mean(x); var(x); hist(x)

# Custom generator
my_custom <- function(n, min = 1, max = 100) sample(min:max, n, replace = TRUE)
x <- simulate_IIDdata(500, "custom", distr_params = list(min = 1, max = 10), generator = my_custom)
mean(x); var(x); plot(x)

# Multivariate example
params <- distr_spec(dim = 3, mean = 1:3, sigma = diag(3))
x <- simulate_IIDdata(5, "mvnorm", params)
plot(x)

# Skew-normal (requires \pkg{sn})
if (requireNamespace("sn", quietly = TRUE)) {
  x <- simulate_IIDdata(50, "skewnorm")
  plot(x)
}

# Copula-based Examples
if (requireNamespace("copula", quietly = TRUE)) {
  library(copula)

  # Gaussian copula with Normal margins
  cop <- normalCopula(param = 0.5, dim = 3)
  margins <- list(
    list(dist = "norm", params = list(mean = 0, sd = 1)),
    list(dist = "norm", params = list(mean = 1, sd = 2)),
    list(dist = "norm", params = list(mean = -1, sd = 0.5))
  )
  x<-simulate_IIDdata(5, "copula", list(dim = 3, copula = cop, margins = margins))
  plot(x)

  # Gumbel copula with mixed margins
  gumbel_cop <- gumbelCopula(param = 2, dim = 4)
  mixed_margins <- list(
    list(dist = "norm", params = list(mean = 0, sd = 1)),
    list(dist = "gamma", params = list(shape = 3, rate = 1)),
    list(dist = "exp", params = list(rate = 2)),
    list(dist = "unif", params = list(min = 0, max = 1))
  )
  x <- simulate_IIDdata(10, "copula", list(dim = 4, copula = gumbel_cop, margins = mixed_margins))
  plot(x)

  # Large-dimensional Gaussian copula with exponential margins
  d <- 20
  exp_margins <- replicate(d, list(dist = "exp", params = list(rate = 1)), simplify = FALSE)
  rho <- 0.3
  Sigma <- matrix(rho, nrow = d, ncol = d); diag(Sigma) <- 1
  norm_cop <- normalCopula(P2p(Sigma), dim = d, dispstr = "un")
  x_large <- simulate_IIDdata(10, "copula", list(dim = d, copula = norm_cop, margins = exp_margins))
  dim(x_large)  # should be 10 x 20
  plot(x)
}

}
\references{
\itemize{
\item Azzalini A, Capitanio A (2013). \emph{The Skew-Normal and Related Families} Cambridge University Press. ISBN 978-1-107-02927-9. \href{https://www.cambridge.org/core/books/skewnormal-and-related-families/4B9A3CD9D58EB6022FC1D21E1E08A10E}{Link}
\item Adcock C, Dias A, Salmon M (Eds) (2013). \emph{Copulae & Multivariate Probability Distributions in Finance} Routledge. ISBN 978-0-415-81485-0. \href{https://www.routledge.com/Copulae-and-Multivariate-Probability-Distributions-in-Finance/Adcock-Dias-Salmon/p/book/9780415814850}{Link}
\item Durante F, Sempi C (2015). \emph{Principles of Copula Theory} CRC Press. ISBN 978-1-439-88442-3. \href{https://www.routledge.com/Principles-of-Copula-Theory/Durante-Sempi/p/book/9781439884423}{Link}
\item Genton MG (Ed) (2004). \emph{Skew-Elliptical Distributions and Their Applications: A Journey Beyond Normality} Chapman & Hall / CRC Press. ISBN 978-0-415-36559-7. \href{https://www.routledge.com/Skew-Elliptical-Distributions-and-Their-Applications-A-Journey-Beyond-Normality/Genton/p/book/9780367578312}{Link}
\item Johnson NL, Kotz S, Balakrishnan N (1994). \emph{Continuous Univariate Distributions, Volume 1} (2nd ed.) Wiley. ISBN 978-0-471-58495-7. \href{https://www.wiley.com/en-us/Continuous+Univariate+Distributions\%2C+Volume+1\%2C+2nd+Edition-p-9780471584957}{Link}
\item Johnson NL, Kotz S, Balakrishnan N (1995). \emph{Continuous Univariate Distributions, Volume 2} (2nd ed.) Wiley. ISBN 978-0-471-58494-0. \href{https://www.wiley.com/en-us/Continuous+Univariate+Distributions\%2C+Volume+2\%2C+2nd+Edition-p-9780471584940}{Link}
\item Johnson NL, Kotz S, Balakrishnan N (1997). \emph{Discrete Multivariate Distributions} Wiley. ISBN 978-0-471-12844-1. \href{https://www.wiley.com/en-us/Discrete+Multivariate+Distributions-p-9780471128441}{Link}
\item Johnson NL, Kotz S, Kemp AW (2005). \emph{Univariate Discrete Distributions} (3rd ed.) Wiley. ISBN 978-0-471-27246-5. \href{https://www.wiley.com/en-us/Univariate+Discrete+Distributions\%2C+3rd+Edition-p-9780471272465}{Link}
\item Kotz S, Balakrishnan N, Johnson NL (2000). \emph{Continuous Multivariate Distributions, Volume 1: Models & Applications} (2nd ed.) Wiley. ISBN 978-0-471-18387-7. \href{https://www.wiley.com/en-us/Continuous+Multivariate+Distributions\%2C+Volume+1\%3A+Models+and+Applications-p-9780471183877}{Link}
\item Lai CD, Balakrishnan N (2002). \emph{Continuous Bivariate Distributions} Springer. \href{https://link.springer.com/book/10.1007/b101765}{Link}
\item Nelsen RB (2006). \emph{An Introduction to Copulas} (2nd ed.) Springer. \href{https://link.springer.com/book/10.1007/0-387-28678-0}{Link}
}
}
\seealso{
\code{\link[=distr_spec]{distr_spec()}}, \code{\link{match.fun.allR}}, \link{summary.IIDdata}, \link{plot.IIDdata}
}
