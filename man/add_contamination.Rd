% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_contamination.r
\name{add_contamination}
\alias{add_contamination}
\title{Add Contamination to Simulated Data}
\usage{
add_contamination(simData, cont_pos = list(), cont_settings = list())
}
\arguments{
\item{simData}{Numeric vector, matrix, named list, or simulation object
(of class \code{LMMdata}, \code{GLMMdata}, \code{LMdata}, \code{GLMdata}, \code{IIDdata}).
\itemize{
\item If a \strong{list}, it must include the component specified in \code{cont_pos$name}.
\item If a \strong{vector/matrix}, it is treated as the target component to contaminate.
}}

\item{cont_pos}{Named list specifying the target component to contaminate:
\describe{
\item{name}{Character string, one of \code{"y"}, \code{"X"}, or \code{"Z"} (default: \code{y}).
Determines which component of the simulation object is modified.}
\item{col}{Vector of column indices to contaminate.
If \code{col = NULL} (default) or \code{name = "y"}, all columns are contaminated.
For \code{y}, multiple columns usually represent replications in the simulation object,
and all such columns are contaminated consistently.}
}}

\item{cont_settings}{Named list specifying contamination details:
\describe{
\item{cont_mode}{Mode of contamination: \code{"casewise"} (default) or \code{"cellwise"}.
- \code{"casewise"}: Same rows contaminated across all specified columns.
- \code{"cellwise"}: Different rows may be contaminated independently per column.}
\item{cont_prop}{Proportion of contamination (0–1).
In \code{casewise} mode, this is the proportion of rows.
In \code{cellwise} mode, this is the proportion of cells across all selected columns.
(default: \code{0.1})}

\item{cont_value}{Optional numeric scalar or vector specifying contamination values.
If provided, this overrides \code{cont_distr} and no random generation occurs.
\emph{Length must be either 1 or equal to the number of contaminated columns}.}

\item{cont_distr}{Named list describing the distribution of contamination
values (only when \code{cont_value} is not provided).
Accepts:
\describe{
\item{distr_name}{Distribution name (e.g., \code{"norm"}, \code{"t"}, \code{"unif"}).}
\item{distr_params}{List of distribution parameters (see \link{simulate_IIDdata}).}
\item{generator}{Optional custom generator function.}
}
The default is the standard normal distribution.}

\item{cont_type}{Character string specifying the contamination mechanism:
\describe{
\item{"additive"}{Adds contamination values to selected rows/cells (default).}

\if{html}{\out{<div class="sourceCode">}}\preformatted{  \\item\{"multiplicative"\}\{Multiplies values in selected rows/cells
     by contamination values.\}

  \\item\{"replace"\}\{Replaces values in selected rows/cells with contamination values.\}

  \\item\{"outlier"\}\{Sets selected rows/cells to extreme values of the form:
\deqn{\text{mean} \pm (\text{sd} \times \text{outlier_factor}).}
   This generates classical point outliers.\}

  \\item\{"leverage"\}\{Generates high-leverage points in `X` or `Z`.
    Corresponding rows in `y` (if present) are shifted in the opposite direction.
    See *Details* for full description.\}
\}\}
}\if{html}{\out{</div>}}

\item{leverage_factor}{Numeric multiplier controlling the magnitude
of leverage contamination  (default: \code{5}).}

\item{outlier_factor}{Numeric multiplier controlling extreme values for \code{"outlier"}
or \code{y} shifts in \code{"leverage"} (default: \code{5}).}

\item{outlier_dir}{Probability that an outlier is generated in the right
(positive) tail versus the left (negative) tail.
Default: \code{1} (all outliers on the right).}
}}
}
\value{
Modified simulated datasets of the same class/structure as the input,
with the requested contamination applied.
\itemize{
\item If \code{simData} is a list, the contaminated component is replaced.
\item If a vector or matrix is supplied, the returned object is the contaminated matrix.
}
}
\description{
Introduces controlled contamination into simulated datasets.

Contamination can be applied to:
\itemize{
\item \strong{Mixed Model datasets} (of class \code{LMMdata} or \code{GLMMdata})
\item \strong{Regression datasets} (of class \code{LMdata} or \code{GLMdata})
\item \strong{IID samples} (of class \code{IIDdata})
\item \strong{Named lists} containing components such as:
\itemize{
\item \code{y}: response vector or matrix
\item \code{X}: fixed-effects design matrix
\item \code{Z}: random-effects design matrix (optional)
}
}

Numeric vectors or matrices are treated as IID samples (columns = variables).
}
\details{
The function provides a general framework for injecting various forms of contamination
into simulated data, useful for robustness studies and sensitivity analyses.

\strong{Contamination mode:}
\itemize{
\item \emph{Casewise}: A total of \verb{ceil(n × cont_prop)} rows are selected and
contaminated across all columns.
\item \emph{Cellwise}: A proportion of individual cells is contaminated independently
in each specified column. Rows are re-sampled independently per column.
}

\emph{Leverage contamination:}
For \code{cont_type = "leverage"} applied to \code{X} or \code{Z},
a subset of rows/cells is randomly selected for contamination.
Their values are set to the column mean plus a random shift,
drawn from a normal distribution with the column's standard deviation scaled by \code{leverage_factor}.
If a \code{y} component exists, the corresponding rows are shifted in the opposite direction,
scaled by \code{outlier_factor}, creating influential points within the regression framework.

\emph{Distribution-based contamination:}
When \code{cont_value = NULL}, random contamination values are generated using
\code{simulate_IIDdata()}, allowing flexible custom distributions or user-provided generators.
}
\examples{
# Additive contamination to an IID sample
set.seed(1)
x <- rnorm(100)
contaminated <- add_contamination(
  x,
  cont_pos = list(name="y", col=1),
  cont_settings = list(
    cont_prop = 0.1,
    cont_type = "additive",
    cont_distr = list(distr_name="norm", distr_params=list(mean=5, sd=1))
  )
)


# Outlier contamination in regression response
set.seed(2)
sim <- list(y = rnorm(200), X = cbind(1, rnorm(200)))

sim_outliers <- add_contamination(
  sim,
  cont_pos = list(name="y"),
  cont_settings = list(
    cont_type="outlier",
    outlier_factor=8,
    outlier_dir=0.8
  )
)


# High-leverage contamination in design matrix X
set.seed(3)
sim <- list(
  y = rnorm(150),
  X = cbind(1, rnorm(150), rnorm(150))
)

sim_lev <- add_contamination(
  sim,
  cont_pos = list(name="X", col=2:3),
  cont_settings = list(
    cont_type="leverage",
    leverage_factor=10,
    outlier_factor=6
  )
)

# Cellwise contamination (different rows per column)
set.seed(4)
mat <- matrix(rnorm(50*3), ncol=3)
cont_cell <- add_contamination(
  mat,
  cont_pos = list(name="X", col=1:3),
  cont_settings = list(
    cont_prop=0.1,
    cont_type="replace",
    cont_value=99,
    cont_mode="cellwise"
  )
)

}
